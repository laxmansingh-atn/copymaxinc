<?php$segments = $this->uri->total_segments();$lang_code = get_current_language(); // Helper "current_language_helper.php"?><div id="page-wrapper">    <div class="container-fluid">        <div class="row">            <div class="col-lg-12">                <h1 class="page-header"><?= $page_title;?></h1>            </div>            <!-- /.col-lg-12 -->        </div>        <!-- /.row -->        <div class="col-md-12 breadcrumb_area1">        <div class="col-md-10">          <ol class = "breadcrumb">            <li><a href = "<?= base_url('admin/dashboard');?>"><i class="fa fa-home"></i></a></li>            <li><a href = "<?= base_url('admin/dashboard');?>">Home</a></li>            <li class = ""><a href = "<?= base_url('admin/weight_management') ?>/"><?= $page_title;?></a></li>            <li class = "active"><?= ucfirst($this->uri->segment(3));?></li>          </ol>          </div>                <?php if(end($this->uri->segments) != "add"){?>            <div class="col-md-2 txt_right">               <a href="<?= base_url('admin/weight_management') ?>/add"><button type="button" class="btn btn-success">ADD NEW</button></a>            </div>        <?php } ?>        </div>               <?php            if(!empty($error) && $error == "error")            {		  ?>            <div class="col-md-12 alert alert-danger"><?= $this->session->flashdata('update_message');?></div>          <?php            }			else if(!empty($error) && $error == "success")			{		  ?>            <div class="col-md-12 alert alert-success"><?= $this->session->flashdata('update_message');?></div>          <?php			}			else if($this->session->flashdata('update_message'))			{			?>				<div class="col-md-12 alert alert-success"><?= $this->session->flashdata('update_message');?></div>			<?php			}		  ?>                  <?php if(end($this->uri->segments) == "add"){ ?>                  <form action="" method="post" enctype="multipart/form-data">                        <div class="row">                <div class="col-md-6">                    <div class="form-group">                        <label>Select Product </label>                        <select class="form-control" type="text" id="product_id" name="product_id" required="required">                            <option value="">Select Product</option>                            <?php foreach($product_list as $products){?>                                <option value="<?=$products['product_id']?>"><?=$products['product_name']?></option>                            <?php } ?>                        </select>                    </div>                </div>                            </div>                        <div class="add_more_paste">            <div class="row add_more_div">                            <div class="col-md-3">                        <div class="form-group">                            <label>Dimension </label>                            <select class="form-control dimension" type="text"  name="dimension[]" required="required">                                <option value="">Select Dimension</option>                                                            </select>                        </div>                    </div>                    <div class="col-md-3">                        <div class="form-group">                            <label>Select Paper Type </label>                            <select class="form-control master_printing_attribute_id" type="text" name="master_printing_attribute_id[]" required="required">                                <option value="">Select Paper Type</option>                                                            </select>                        </div>                    </div>                    <div class="col-md-2">                        <div class="form-group">                            <label>Weight /50 Sheets</label>                            <input class="form-control weight" type="text"  name="weight[]" required="required">                        </div>                    </div>                                    <div class="col-md-2">                        <div class="form-group">                            <label>Height /50 Sheets</label>                            <input class="form-control height" type="text"  name="height[]" required="required">                        </div>                    </div>                                                              <div class="col-md-2 add_more_btn_cls">                    <button type="button" id="add_more_btn" class="btn btn-primary" style="margin-top:25px;">+ Add More</button>                </div>                                        </div>             </div>                        	<hr>          	<div class="col-md-12 text-right mar_b_3">                                <input type="submit" name="submit" value="SUBMIT" class="btn btn-success" />                                <a href="<?= base_url();?>admin/weight_management/">                    <button type="button" name="cancel" class="btn btn-default">CANCEL</button>                </a>                        </div>			          </form>          <?php } elseif($this->uri->segment($segments-1) == "edit") { ?>                        <form action="" method="post" enctype="multipart/form-data">                        <div class="row">                <div class="col-md-6">                    <div class="form-group">                        <label>Select Product </label>                        <input  type="hidden" id="product_id_hidden" name="product_id" value="<?=$this->uri->segment(4)?>">                        <select class="form-control" type="text" id="product_id"  required="required" disabled>                            <option value="">Select Product</option>                            <?php foreach($product_list as $products){?>                                <option value="<?=$products['product_id']?>" <?php echo ($products['product_id'] == $this->uri->segment(4))?"selected":"";?>><?=$products['product_name']?></option>                            <?php } ?>                        </select>                    </div>                </div>                            </div>                        <div class="add_more_paste">                        </div>                        	<hr>          	<div class="col-md-12 text-right mar_b_3">                            <input type="submit" name="edit" value="UPDATE" class="btn btn-info" />              <a href="<?= base_url();?>admin/weight_management/">                <button type="button" name="cancel" class="btn btn-default">CANCEL</button>              </a>            </div>			          </form>                      <?php } else { ?>            <div class="row">                <div class="col-sm-12">                    <div class="panel panel-default">                    	<div class="panel-heading"> Product Weight Details </div>                    	<div class="panel-body">                    		<div class="dataTable_wrapper">                    			<table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">                                    <thead>                                      <tr>                                        <th>Sl No.</th>                                        <th>Product Name</th>                                        <th>Sheets Count</th>                                        <th>Action</th>                                      </tr>                                    </thead>                    				<tbody>                                        <?php foreach($result as $key=>$results){ ?>                                            <tr>                                                <td><?= ($key+1);?></td>                                                <td><?= $results['product_name'];?></td>                                                <td><?= $results['sheets_count'];?></td>                                                <td class="text-center"><div class="btn-group">                                                <button class="btn btn-default btn-icon dropdown-toggle" data-toggle="dropdown"><i class="fa fa-gears"></i></button>                                                    <ul class="dropdown-menu icons-right dropdown-menu-right" style="padding:0">                                                    <li><a class="edit" href="<?= base_url('admin/weight_management/edit')."/".$results['product_id'];?>"><i class="fa fa-pencil"></i>Edit</a></li>                                                    <li><a class="delete" href="<?= base_url('admin/weight_management/delete')."/".$results['product_id'];?>" onclick="return confirm('Do you want to delete?')"><i class="fa fa-trash"></i>Remove</a></li>                                                    </ul>                                                </div></td>                                            </tr>                                        <?php } ?>                                    </tbody>                    			</table>                    		</div>                    	</div>                    </div>                </div>            </div>            <?php			}		  ?>    	            </div>    <!-- /.container-fluid --></div><script>        $(document).ready(function(){        var product_id = $("#product_id").val();        //alert(product_id);        if(product_id){            get_product_weight_data(product_id);        }        })        $(document).on('change','#product_id',function(){        var product_id = $(this).val();        get_dimension(product_id);    });                function get_dimension(product_id,dimension=null,master_printing_attribute_id=null,product_weight_id=null){                        //console.log(master_printing_attribute_id);            $.ajax({                url: "<?=base_url()?>admin/weight_management/get_dimension",                data: {product_id: product_id},                type: "post",                cache: "false",                dataType:"json",                encode: true,                async:false            })            .done(function(data){                                               if(dimension){                                        $.each(dimension,function(key1,value1){                        var resultHTML='';                        var papertypeHTML='';                        if(data.dimension_list){                                                        var selected_dimension='';                            $.each(data.dimension_list,function(key,value){                                                                selected_dimension=(value.dimension == dimension[key1])?'selected':'';                                                                resultHTML +='<option value="'+value.dimension+'" '+selected_dimension+'>'+value.dimension+'</option>';                            })                        }                        else{                            resultHTML +='<option value="">No Data Found</option>';                        }                        if(data.paper_type_list){                            //console.log(master_printing_attribute_id);                            var selected_paper_type='';                            $.each(data.paper_type_list,function(key,value){                                                                papertypeHTML +=`<optgroup label="`+value.attr_value+`" style="font-weight:bold;">`;                                                                $.each(value.sub_type,function(key2,value2){                                                                                            selected_paper_type= (value2.id == master_printing_attribute_id[key1])?'selected':'';                                                                   papertypeHTML +=`<option value="`+value2.id+`" `+selected_paper_type+`>`+value2.attr_value+`</option>`;                                })                                                                                   papertypeHTML +=`</optgroup>`;                            })                        }                        else{                            papertypeHTML +='<option value="">No Data Found</option>';                        }                        //console.log(papertypeHTML);                                                $("#dimension_"+product_weight_id[key1]).append(resultHTML);                        $("#master_printing_attribute_id_"+product_weight_id[key1]).append(papertypeHTML);                                                                   })                        }                else{                    var resultHTML='';                    var papertypeHTML='';                    if(data.dimension_list){                                                $.each(data.dimension_list,function(key,value){                            resultHTML +='<option value="'+value.dimension+'">'+value.dimension+'</option>';                        })                    }                    else{                        resultHTML +='<option value="">No Data Found</option>';                    }                    if(data.paper_type_list){                                                $.each(data.paper_type_list,function(key,value){                            papertypeHTML +=`<optgroup label="`+value.attr_value+`" style="font-weight:bold;">`;                                                        $.each(value.sub_type,function(key,value){                                                    papertypeHTML +=`<option value="`+value.id+`">`+value.attr_value+`</option>`;                            })                                                                           papertypeHTML +=`</optgroup>`;                        })                    }                    else{                        papertypeHTML +='<option value="">No Data Found</option>';                    }                    $(".dimension").append(resultHTML);                    $(".master_printing_attribute_id").append(papertypeHTML);                }                        })            .fail(function(jqXHR, ajaxOptions, thrownError){                alert('server not responding...');            });               }        $(document).on('click','#add_more_btn',function(){            var product_id =$("#product_id").val();                        if(product_id){                                $(this).parents('.add_more_div').clone().appendTo(".add_more_paste").find("select,input").val('');                $('.add_more_paste').children().last().find('.add_more_btn_cls').html('<div class="col-md-2"><button type="button" class="btn btn-danger remove_btn" style="margin-top:25px;">- Remove</button></div>');                $("#product_id_hidden").val(product_id);            }            else{                alert('Please select product first');            }                })        $(document).on('click','.remove_btn',function(){                        $(this).parents('.add_more_div').remove();        })        function get_product_weight_data(product_id){            $.ajax({                url: "<?=base_url()?>admin/weight_management/get_product_weight_data",                data: {product_id: product_id},                type: "post",                cache: "false",                dataType:"json",                encode: true,                async:false            })            .done(function(data){                var resultHTML='';                var dimension=[];                var master_printing_attribute_id=[];                var product_weight_id=[];                if(data.paper_weight_list){                                        $.each(data.paper_weight_list,function(key,value){                                            resultHTML +=`<div class="row add_more_div">                                <input type="hidden" name="product_weight_id[]" data-product_weight_id="`+value.product_weight_id+`" value="`+value.product_weight_id+`">                                <div class="col-md-3">                                    <div class="form-group">                                        <label>Dimension </label>                                        <select id="dimension_`+value.product_weight_id+`"  class="form-control dimension" type="text"  name="dimension[]" required="required">                                            <option value="">Select Dimension</option>                                                                                    </select>                                    </div>                                </div>                                <div class="col-md-3">                                    <div class="form-group">                                        <label>Select Paper Type </label>                                        <select id="master_printing_attribute_id_`+value.product_weight_id+`" class="form-control master_printing_attribute_id" type="text" name="master_printing_attribute_id[]" required="required">                                            <option value="">Select Paper Type</option>                                                                                    </select>                                    </div>                                </div>                                <div class="col-md-2">                                    <div class="form-group">                                        <label>Weight /50 Sheets</label>                                        <input class="form-control weight" type="text"  name="weight[]" required="required" value="`+value.weight+`">                                    </div>                                </div>                                                            <div class="col-md-2">                                    <div class="form-group">                                        <label>Height /50 Sheets</label>                                        <input class="form-control height" type="text"  name="height[]" required="required" value="`+value.height+`">                                    </div>                                </div>`;                                                        if(key==0){                                                            resultHTML+=`<div class="col-md-2 add_more_btn_cls">                                    <button type="button" id="add_more_btn" class="btn btn-primary" style="margin-top:25px;">+ Add More</button>                                </div>`;                            }                            else{                                resultHTML+=`<div class="col-md-2">                                    <button type="button"  class="btn btn-danger remove_btn" style="margin-top:25px;">- Remove</button>                                </div>`;                               }                            resultHTML+=`</div>`;                            dimension.push(value.dimension);                            master_printing_attribute_id.push(value.master_printing_attribute_id);                            product_weight_id.push(value.product_weight_id);                                                                    })                }                else{                    resultHTML +='<span>No Data Found</span>';                }                $(".add_more_paste").html(resultHTML);                get_dimension(product_id,dimension,master_printing_attribute_id,product_weight_id);                            })            .fail(function(jqXHR, ajaxOptions, thrownError){                alert('server not responding...');            });        }    </script>